<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>üß† AI Script Fixer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap @5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light text-dark">
<div class="container py-5">
    <h1 class="mb-4">üß† AI-Powered Script Fixer</h1>
    <p class="lead">–°–µ—Ä–≤–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ —á–µ—Ä–µ–∑ –ò–ò</p>

    <hr class="my-4">

    <div class="row">
        <div class="col-md-6">
            <h3>‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç</h3>
            <form id="runForm" action="/run" method="post">
                <input type="hidden" name="script_path" value="../scripts/SelfConfiguring-FaissCache.ps1">
                <button type="submit" class="btn btn-success">–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
            </form>
        </div>
        <div class="col-md-6">
            <h3>üìÅ –ò—Å—Ç–æ—Ä–∏—è —Ñ–∏–∫—Å–æ–≤</h3>
            {% if history %}
                <ul class="list-group">
                {% for item in history %}
                    <li class="list-group-item">{{ loop.index }}. {{ item.script }} ‚Üí {{ item.status }}</li>
                {% endfor %}
                </ul>
            {% else %}
                <p class="text-muted">–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞ –ø—É—Å—Ç–∞.</p>
            {% endif %}
        </div>
    </div>

    <hr class="my-4">

    <div class="card mt-4">
        <div class="card-body">
            <h5 class="card-title">üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h5>
            <a href="/docs" class="btn btn-primary me-2">Swagger Docs</a>
            <a href="/redoc" class="btn btn-outline-secondary me-2">ReDoc</a>
            <a href="http://localhost:8501" target="_blank" class="btn btn-info text-white">Web UI</a>
        </div>
    </div>
</div>

<!-- –î–æ–±–∞–≤–ª—è–µ–º JavaScript –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON -->
<script>
document.getElementById('runForm').addEventListener('submit', async function (e) {
    e.preventDefault();

    const form = e.target;
    const scriptPath = form.querySelector("input[name='script_path']").value;

    const response = await fetch(form.action, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ script_path: scriptPath, max_retries: 5 })
    });

    const result = await response.json();
    alert(result.status === 'success' ? '‚úÖ –°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω!' : '‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏—Å–ø—Ä–∞–≤–∏—Ç—å');
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap @5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<a href="/script/edit" class="btn btn-outline-primary me-2">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç</a>
<a href="/script/list" class="btn btn-outline-secondary me-2">üìã –°–ø–∏—Å–æ–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤</a>

</body>
</html>